<?xml version="1.0"?>

<project name="test" basedir="." default="test">
	<import file="../build-common-java.xml" />

	<target name="test" depends="compile">
		<echo message="These tests require a running Liferay instance. Make sure that Liferay is" />
		<echo message="listening on a host that matches what is set in test.properties." />
		<echo message="" />

		<path id="ejb.classpath">
			<fileset dir="${app.server.dir}/lib" includes="*.jar" />
			<fileset dir="${app.server.dir}/server/default/lib" includes="*.jar" />
			<path refid="project.classpath" />
		</path>

		<java
			classname="com.liferay.test.EJBTests"
			classpathref="ejb.classpath"
			fork="true"
			newenvironment="true"
		>
			<jvmarg value="-Djava.security.auth.login.config=${app.server.dir}/client/auth.conf" />
		</java>

		<java
			classname="com.liferay.test.HttpTests"
			classpathref="project.classpath"
			fork="true"
			newenvironment="true"
		/>

		<path id="junit.classpath">
			<pathelement path="${project.dir}/lib/development/junit.jar;${project.dir}/test/classes" />
		</path>

		<path id="portal-client.classpath">
			<pathelement path="${project.dir}/lib/development/activation.jar;${project.dir}/lib/development/mail.jar;${project.dir}/lib/portal/axis.jar;${project.dir}/lib/portal/commons-discovery.jar;${project.dir}/lib/portal/commons-logging.jar;${project.dir}/lib/portal/concurrent.jar;${project.dir}/lib/portal/jaxrpc.jar;${project.dir}/lib/portal/saaj.jar;${project.dir}/lib/portal/trove.jar;${project.dir}/lib/portal/wsdl4j.jar;${project.dir}/portal-client/portal-client.jar;${project.dir}/util-java/util-java.jar" />
			<path refid="junit.classpath" />
		</path>

		<java
			classname="com.liferay.test.SoapTests"
			classpathref="portal-client.classpath"
			fork="true"
			newenvironment="true"
		/>
	</target>
</project>