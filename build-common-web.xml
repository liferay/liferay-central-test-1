<?xml version="1.0"?>

<project name="build-common-web">
	<import file="build-common.xml" />

	<target name="clean">
		<delete file="${war.file}.war" failonerror="false" />
	</target>

	<target name="war">
		<war
			basedir="docroot"
			destfile="${war.file}.war"
			excludes="WEB-INF/web.xml"
			webxml="docroot/WEB-INF/web.xml"
		>
			<manifest>
				<attribute name="Class-Path" value="${classpath.manifest}" />
			</manifest>
		</war>
	</target>

	<target name="deploy" depends="war">
		<if>
			<or>
				<equals arg1="${app.server.type}" arg2="jboss-jetty" />
				<equals arg1="${app.server.type}" arg2="jboss-tomcat" />
			</or>
			<then>
				<property name="war.file.dest" value="${app.server.portal.dir}/${war.file}.war" />
			</then>
			<else>
				<property name="war.file.dest" value="${app.server.deploy.dir}/${war.file}" />
			</else>
		</if>

		<unwar src="${war.file}.war" dest="${war.file.dest}" />
	</target>
</project>