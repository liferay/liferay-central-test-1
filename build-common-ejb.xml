<?xml version="1.0"?>

<project name="build-common-ejb">
	<import file="build-common-java.xml" />

	<target name="jar" depends="compile">
		<manifest file="classes/META-INF/MANIFEST.MF.JOnAS">
			<attribute name="Class-Path" value="${classpath.manifest.jonas}" />
		</manifest>

		<jar
			basedir="classes"
			jarfile="${jar.file}.jar"
		>
			<manifest>
				<attribute name="Class-Path" value="portal-ejb.jar ${classpath.manifest}" />
			</manifest>
		</jar>

		<copy file="${jar.file}.jar" todir="${project.dir}/portal-ear/modules" />
	</target>

	<target name="deploy" depends="jar">
		<if>
			<or>
				<equals arg1="${app.server.type}" arg2="jboss-jetty" />
				<equals arg1="${app.server.type}" arg2="jboss-tomcat" />
			</or>
			<then>
				<unjar src="${jar.file}.jar" dest="${app.server.portal.dir}/${jar.file}.jar" />
			</then>
			<else>
				<copy file="${jar.file}.jar" todir="${app.server.lib.portal.dir}" />
			</else>
		</if>
	</target>
</project>