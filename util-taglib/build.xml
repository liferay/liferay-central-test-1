<?xml version="1.0"?>

<project name="util-taglib" basedir="." default="compile">
	<import file="../build-common-java.xml" />

	<property name="jar.file" value="${ant.project.name}" />

	<target name="jar">
		<antcall target="build-common-java.jar" />

		<copy file="${jar.file}.jar" todir="${project.dir}/portal-ejb/classes/com/liferay/portal/deploy/dependencies" />

		<copy todir="${project.dir}/portal-ejb/classes/com/liferay/portal/deploy/dependencies">
			<fileset dir="classes/META-INF" />
		</copy>

		<copy file="${jar.file}.jar" todir="${project.dir}/portal-web/docroot/WEB-INF/lib" />

		<copy todir="${project.dir}/portal-web/docroot/WEB-INF/tld">
			<fileset dir="classes/META-INF" />
		</copy>

		<copy file="classes/META-INF/liferay-security.tld" todir="${project.dir}/portlets/sample-permissions-portlet.war/WEB-INF/tld" />
		<copy file="classes/META-INF/liferay-theme.tld" todir="${project.dir}/portlets/sample-permissions-portlet.war/WEB-INF/tld" />

		<copy file="classes/META-INF/liferay-ui.tld" todir="${project.dir}/portlets/sample-ui-taglibs-portlet.war/WEB-INF/tld" />
	</target>

	<target name="deploy" depends="jar">
		<if>
			<equals arg1="${app.server.type}" arg2="tomcat" />
			<then>
				<copy file="${jar.file}.jar" todir="${app.server.deploy.dir}/ROOT/WEB-INF/lib" />

				<copy todir="${app.server.deploy.dir}/ROOT/WEB-INF/tld">
					<fileset dir="classes/META-INF" />
				</copy>
			</then>
		</if>
	</target>
</project>