<?xml version="1.0"?>

<custom-sql>
	<sql id="com.liferay.portlet.blogs.service.persistence.BlogsEntryFinder.countDiscussionsByGroupId">
		<![CDATA[
			SELECT
				COUNT(MBMessage.messageId) AS COUNT_VALUE
			FROM
				MBMessage, BlogsEntry
			WHERE
				(BlogsEntry.entryId = MBMessage.classPK) AND
				(MBMessage.parentMessageId != 0)
				[$GROUP_ID$]
				[$STATUS$]
		]]>
	</sql>
	<sql id="com.liferay.portlet.blogs.service.persistence.BlogsEntryFinder.countByOrganizationIds">
		<![CDATA[
			SELECT
				COUNT(*) AS COUNT_VALUE
			FROM
				BlogsEntry
			INNER JOIN
				User_ ON
					(User_.userId = BlogsEntry.userId)
			INNER JOIN
				Users_Orgs ON
					(Users_Orgs.userId = User_.userId)
			WHERE
				[$ORGANIZATION_ID$] AND
				(BlogsEntry.displayDate < ?)
				[$STATUS$]
		]]>
	</sql>
	<sql id="com.liferay.portlet.blogs.service.persistence.BlogsEntryFinder.findDiscussionsByGroupId">
		<![CDATA[
			SELECT
				{MBMessage.*}
			FROM
				MBMessage, BlogsEntry
			WHERE
				(BlogsEntry.entryId = MBMessage.classPK) AND
				(MBMessage.parentMessageId != 0)
				[$GROUP_ID$]
				[$STATUS$]
			ORDER BY
				MBMessage.modifiedDate DESC
		]]>
	</sql>
	<sql id="com.liferay.portlet.blogs.service.persistence.BlogsEntryFinder.findByOrganizationIds">
		<![CDATA[
			SELECT
				{BlogsEntry.*}
			FROM
				BlogsEntry
			INNER JOIN
				User_ ON
					(User_.userId = BlogsEntry.userId)
			INNER JOIN
				Users_Orgs ON
					(Users_Orgs.userId = User_.userId)
			WHERE
				[$ORGANIZATION_ID$] AND
				(BlogsEntry.displayDate < ?)
				[$STATUS$]
			ORDER BY
				BlogsEntry.displayDate DESC
		]]>
	</sql>
	<sql id="com.liferay.portlet.blogs.service.persistence.BlogsEntryFinder.findByNoAssets">
		<![CDATA[
			SELECT
				{BlogsEntry.*}
			FROM
				BlogsEntry
			WHERE
				(entryId NOT IN(
					SELECT
						classPK
					FROM
						AssetEntry
					WHERE
						classNameId = [$CLASS_NAME_ID_COM.LIFERAY.PORTLET.BLOGS.MODEL.BLOGSENTRY$]
				))
		]]>
	</sql>
	<sql id="com.liferay.portlet.blogs.service.persistence.BlogsStatsUserFinder.countByOrganizationIds">
		<![CDATA[
			SELECT
				COUNT(*) AS COUNT_VALUE
			FROM
				BlogsStatsUser
			INNER JOIN
				User_ ON
					(User_.userId = BlogsStatsUser.userId)
			INNER JOIN
				Users_Orgs ON
					(Users_Orgs.userId = User_.userId)
			WHERE
				(BlogsStatsUser.entryCount != 0) AND
				[$ORGANIZATION_ID$]
		]]>
	</sql>
	<sql id="com.liferay.portlet.blogs.service.persistence.BlogsStatsUserFinder.findByOrganizationIds">
		<![CDATA[
			SELECT
				{BlogsStatsUser.*}
			FROM
				BlogsStatsUser
			INNER JOIN
				User_ ON
					(User_.userId = BlogsStatsUser.userId)
			INNER JOIN
				Users_Orgs ON
					(Users_Orgs.userId = User_.userId)
			WHERE
				(BlogsStatsUser.entryCount != 0) AND
				[$ORGANIZATION_ID$]
		]]>
	</sql>
</custom-sql>