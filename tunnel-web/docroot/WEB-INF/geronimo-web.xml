<?xml version="1.0"?>

<web-app xmlns="http://geronimo.apache.org/xml/ns/j2ee/web-1.1">
	<environment>
		<moduleId>
			<groupId>liferay</groupId>
			<artifactId>liferay-tunnel-tomcat</artifactId>
			<version>4.3.0</version>
			<type>car</type>
		</moduleId>
		<dependencies>
			<dependency>
				<artifactId>sharedlib</artifactId>
			</dependency>
			<dependency>
				<groupId>liferay</groupId>
				<artifactId>liferay-portal-tomcat</artifactId>
				<type>car</type>
			</dependency>
		</dependencies>
		<inverse-classloading/>
	</environment>
	<security-realm-name>PortalRealm</security-realm-name>
	<security>
		<default-principal>
			<principal name="anonymous" class="com.liferay.portal.security.jaas.PortalPrincipal" />
		</default-principal>
		<role-mappings>
			<role role-name="users">
				<principal class="com.liferay.portal.security.jaas.PortalRole" name="users" />
			</role>
		</role-mappings>
	</security>
	<gbean name="PortalRealm" class="org.apache.geronimo.security.realm.GenericSecurityRealm">
		<attribute name="realmName">PortalRealm</attribute>
		<reference name="ServerInfo">
			<name>ServerInfo</name>
		</reference>
		<reference name="LoginService">
			<name>JaasLoginService</name>
		</reference>
		<xml-reference name="LoginModuleConfiguration">
			<log:login-config xmlns:log="http://geronimo.apache.org/xml/ns/loginconfig-1.1">
				<log:login-module control-flag="REQUIRED" server-side="true" wrap-principals="false">
					<log:login-domain-name>PortalRealm-login</log:login-domain-name>
					<log:login-module-class>com.liferay.portal.security.jaas.ext.tomcat.PortalLoginModule</log:login-module-class>
				</log:login-module>
			</log:login-config>
		</xml-reference>
	</gbean>
</web-app>